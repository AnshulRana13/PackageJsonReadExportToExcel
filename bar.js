var Excel=require("exceljs"),_=require("underscore"),find=require("find"),pkgInfo=[],pkgJsonPath=[],argslist=[],corruptedCount=0;process.argv.forEach(function(d,e){argslist.push(d)});var __dirname=argslist[2],_SaveExcelPath=argslist[3];
find.file(/\\package.json$/,__dirname,function(d){_.each(d,function(e,a){d[a].toString();e=d[a].split("\\");var b="";_.each(e,function(a,c){b=b+a+"/"});b=b.slice(0,-1);pkgJsonPath[a]=b;try{var c=require(b);null!=c&&(a={},a.AuthorName=null!=(c.author&&c.author.name)?c.author.name:"",a.Version=null!=c.version?c.version:"NotFound",a.homepage=null!=c.homepage?c.homepage:b,a.Componentname=null!=c.name?c.name:"",pkgInfo.push(a))}catch(f){corruptedCount++,console.log(f.message)}});console.log("Total File Found is :  "+
pkgJsonPath.length);console.log("No. Of file corrupt is :  "+(pkgJsonPath.length-pkgInfo.length));CreateWorkBook(pkgInfo)});
function CreateWorkBook(d){console.log("******************Start Writing to Excel****************");var e=new Excel.Workbook;e.creator="Anshul Rana";var a=e.addWorksheet("Reoprt1",{pageSetup:{paperSize:9,orientation:"landscape"}});a.columns=[{header:"Component  Name",key:"Componentname",width:30},{header:"Version",key:"Version",width:30},{header:"Author Name",key:"AuthorName",width:30},{header:"Homepage",key:"homepage",width:70}];a.getRow(1).font={name:"Arial Black",bold:!0};_.each(d,function(b,c){a.addRow({Componentname:b.Componentname,
Version:b.Version,AuthorName:b.AuthorName,homepage:b.homepage});e.xlsx.writeFile(_SaveExcelPath).then(function(){})});console.log("No. of item added to Excel is : "+d.length);console.log("******************End Writing to Excel****************")};